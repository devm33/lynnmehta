function WDIInstagram(e){this.user={},this.access_tokens=[],this.filters=[],void 0!==e&&(void 0!==e.access_tokens&&(this.access_tokens=e.access_tokens),void 0!==e.filters&&(this.filters=e.filters));var s=this;function t(){return void 0!==s.user&&void 0!==s.user.user_name?s.user.user_name:"undefined"!=typeof wdi_object&&void 0!==wdi_object.user?wdi_object.user.user_name:""}function r(){return void 0!==s.user&&void 0!==s.user.access_token?s.user.access_token:"undefined"!=typeof wdi_object&&void 0!==wdi_object.user&&void 0!==wdi_object.user.access_token?wdi_object.user.access_token:""}this.statusCode={429:function(){console.log(" 429: Too many requests. Try after one hour")}},this.getFilter=function(e){var t=s.filters;if(void 0===t)return!1;for(var r=0;r<t.length;r++)if(t[r].where==e)if("object"==typeof t[r].what&&2==t[r].what.length){if(void 0!==window[t[r].what[0]]&&"function"==typeof window[t[r].what[0]][t[r].what[1]])return window[t[r].what[0]][t[r].what[1]]}else{if("string"!=typeof t[r].what)return"function"==typeof t[r].what&&t[r].what;if("function"==typeof window[t[r].what])return window[t[r].what]}return!1},this.addToken=function(e){"string"==typeof e&&s.access_tokens.push(e)},this.resetTokens=function(){s.access_tokens=[]},this.getTagRecentMedia=function(e,r,o,i){var n=this,c=!1,u=this.statusCode,a=!1,d=this.getFilter("getTagRecentMedia");i=0===parseInt(i)?"top_media":"recent_media",void 0===r||0===r.length||("success"in r&&(c=!0),"statusCode"in r&&(u=r.statusCode),"error"in r&&(a=!0),"args"in r?!0:r.args={},"count"in r?(r.count=parseInt(r.count),(!Number.isInteger(r.count)||r.count<=0)&&(r.count=33)):r.count=33);var f=this.getTagId(e);jQuery.ajax({type:"POST",url:wdi_ajax.ajax_url,dataType:"json",data:{tagname:e,endpoint:i,wdi_nonce:wdi_ajax.wdi_nonce,wdiTagId:f,next_url:o,user_name:t(),action:"wdi_getTagRecentMedia"},success:function(e){if(!1===f&&(f=""),void 0!==e.tag_data){var t=e.tag_data;void 0!==t.tag_id&&(f=t.tag_id);var o=[];void 0!==window.wdi_all_tags&&(o=window.wdi_all_tags),o[t.tag_id]=t,window.wdi_all_tags=o}e=e.response,(e=s.convertHashtagData(e)).meta={code:200},e.tag_id=f,function(e){void 0===e.data&&(e.data=[]);c&&("object"==typeof r.success&&2==r.success.length?void 0!==window[r.success[0]]&&"function"==typeof window[r.success[0]][r.success[1]]&&(d&&(e=d(e,n.filterArguments,r.args)),window[r.success[0]][r.success[1]](e)):"string"==typeof r.success?"function"==typeof window[r.success]&&(d&&(e=d(e,n.filterArguments,r.args)),window[r.success](e)):"function"==typeof r.success&&(d&&(e=d(e,n.filterArguments,r.args)),r.success(e)))}(e=s.addTags(e))},error:function(e){a&&("object"==typeof r.error&&2==r.error.length?"function"==typeof window[r.error[0]][r.error[1]]&&window[r.error[0]][r.error[1]](e):"string"==typeof r.error?"function"==typeof window[r.error]&&window[r.error](e):"function"==typeof r.error&&r.error(e))},statusCode:u})},this.addTags=function(e){for(i in e.data){var s=e.data[i].caption.text;if(void 0!==s&&""!==s&&-1!=s.indexOf("#")){var t=s.split("#");e.data[i].tags=t}}return e},this.getTagId=function(e){var s=[];if("undefined"!=typeof wdi_controller){if(0===(s=wdi_controller.feed_users).length){var t=jQuery("#WDI_feed_users").val();void 0!==t&&""!==t&&(s=JSON.parse(t))}}else void 0!==window.wdi_all_tags&&(s=window.wdi_all_tags);for(var r in s)if(e===s[r].username||"#"+e===s[r].username)return void 0!==s[r].tag_id&&s[r].tag_id;return!1},this.convertHashtagData=function(e){var s={data:[],pagination:{}};for(var t in void 0!==e.paging&&(s.pagination={cursors:{after:e.paging.cursors.after},next_url:e.paging.next}),e.data){var r,o=e.data[t];r="IMAGE"===o.media_type?"image":"VIDEO"===o.media_type?"video":"carousel";var i={id:o.id,user:{id:"",full_name:"",profile_picture:"",username:""},images:{thumbnail:{width:150,height:150,url:o.media_url},low_resolution:{width:320,height:320,url:o.media_url},standard_resolution:{width:1080,height:1080,url:o.media_url}},created_time:o.timestamp,caption:{id:"",text:o.caption,created_time:"",from:{id:"",full_name:"",profile_picture:"",username:""}},user_has_liked:o.like_count>0,likes:{count:o.like_count},tags:[],filter:"Normal",comments:{count:o.comments_count},type:r,link:o.permalink,location:null,attribution:null,users_in_photo:[]};if("IMAGE"===o.media_type||"CAROUSEL_ALBUM"===o.media_type?i.images={thumbnail:{width:150,height:150,url:o.media_url},low_resolution:{width:320,height:320,url:o.media_url},standard_resolution:{width:1080,height:1080,url:o.media_url}}:"VIDEO"===o.media_type&&(i.videos={standard_resolution:{width:640,height:800,url:o.thumb_url},low_bandwidth:{width:480,height:600,url:o.thumb_url},low_resolution:{width:480,height:600,url:o.thumb_url}}),"CAROUSEL_ALBUM"===o.media_type)for(var n in i.carousel_media=[],o.children.data){if("IMAGE"===o.children.data[n].media_type)var c={images:{thumbnail:{width:150,height:150,url:o.children.data[n].media_url},low_resolution:{width:320,height:320,url:o.children.data[n].media_url},standard_resolution:{width:640,height:640,url:o.children.data[n].media_url}},users_in_photo:[],type:"image"};else c={videos:{standard_resolution:{width:640,height:800,url:o.children.data[n].media_url,id:o.children.data[n].id},low_bandwidth:{width:480,height:600,url:o.children.data[n].media_url,id:o.children.data[n].id},low_resolution:{width:480,height:600,url:o.children.data[n].media_url,id:o.children.data[n].id}},users_in_photo:[],type:"video"};i.carousel_media.push(c)}s.data.push(i)}return s},this.searchForTagsByName=function(e,t){var o=this,i=!1,n=this.statusCode,c=!1;filter=this.getFilter("searchForTagsByName"),void 0===t||0===t.length||("success"in t&&(i=!0),"error"in t&&(c=!0),"statusCode"in t&&(n=t.statusCode));var u="https://api.instagram.com/v1/tags/search?q="+e+"&access_token="+r();s.getDataFromCache(function(e){function r(e){i&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(filter&&(e=filter(e,o.filterArguments)),window[t.success[0]][t.success[1]](e)):"string"==typeof t.success?"function"==typeof window[t.success]&&(filter&&(e=filter(e,o.filterArguments)),window[t.success](e)):"function"==typeof t.success&&(filter&&(e=filter(e,o.filterArguments)),t.success(e)))}!1===e?jQuery.ajax({type:"POST",url:u,dataType:"jsonp",success:function(e){s.setDataToCache(u,e),r(e)},error:function(e){c&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:n}):r(e)},u)},this.searchForUsersByName=function(e,s){var t=this,o=!1,i=(this.statusCode,!1),n=this.getFilter("searchForUsersByName");void 0===s||0===s.length||("success"in s&&(o=!0),"error"in s&&(i=!0),"statusCode"in s&&s.statusCode),jQuery.ajax({type:"POST",dataType:"jsonp",url:"https://api.instagram.com/v1/users/search?q="+e+"&access_token="+r(),success:function(e){o&&("object"==typeof s.success&&2==s.success.length?void 0!==window[s.success[0]]&&"function"==typeof window[s.success[0]][s.success[1]]&&(n&&(e=n(e,t.filterArguments)),e.args=s,window[s.success[0]][s.success[1]](e)):"string"==typeof s.success?"function"==typeof window[s.success]&&(n&&(e=n(e,t.filterArguments)),e.args=s,window[s.success](e)):"function"==typeof s.success&&(n&&(e=n(e,t.filterArguments)),e.args=s,s.success(e)))},error:function(e){i&&("object"==typeof s.error&&2==s.error.length?"function"==typeof window[s.error[0]][s.error[1]]&&window[s.error[0]][s.error[1]](e):"string"==typeof s.error?"function"==typeof window[s.error]&&window[s.error](e):"function"==typeof s.error&&s.error(e))},statusCode:this.statusCode})},this.getRecentLikedMedia=function(e){var s=this,t=!1,o=this.statusCode,i=!1,n=this.getFilter("getRecentLikedMedia"),c="https://api.instagram.com/v1/users/self/media/liked?access_token="+r();void 0===e||0===e.length||("success"in e&&(t=!0),"error"in e&&(i=!0),"statusCode"in e&&(o=e.statusCode),"args"in e?argFlag=!0:e.args={},"count"in e?(e.count=parseInt(e.count),(!Number.isInteger(e.count)||e.count<=0)&&(e.count=20)):e.count=20,c+="&count="+e.count,"next_max_like_id"in e&&(c+="&next_max_like_id="+e.next_max_like_id)),jQuery.ajax({type:"POST",dataType:"jsonp",url:c,success:function(r){t&&("object"==typeof e.success&&2==e.success.length?void 0!==window[e.success[0]]&&"function"==typeof window[e.success[0]][e.success[1]]&&(n&&(r=n(r,s.filterArguments,e.args)),window[e.success[0]][e.success[1]](r)):"string"==typeof e.success?"function"==typeof window[e.success]&&(n&&(r=n(r,s.filterArguments,e.args)),window[e.success](r)):"function"==typeof e.success&&(n&&(r=n(r,s.filterArguments,e.args)),e.success(r)))},error:function(s){i&&("object"==typeof e.error&&2==e.error.length?"function"==typeof window[e.error[0]][e.error[1]]&&window[e.error[0]][e.error[1]](s):"string"==typeof e.error?"function"==typeof window[e.error]&&window[e.error](s):"function"==typeof e.error&&e.error(s))},statusCode:o})},this.getUserRecentMedia=function(e,s){var t=this,o=!1,i=this.statusCode,n=!1,c=this.getFilter("getUserRecentMedia"),u="https://api.instagram.com/v1/users/"+e+"/media/recent/?access_token="+r();void 0===s||0===s.length||("success"in s&&(o=!0),"statusCode"in s&&(i=s.statusCode),"args"in s?!0:s.args={},"error"in s&&(n=!0),"count"in s?(s.count=parseInt(s.count),(!Number.isInteger(s.count)||s.count<=0)&&(s.count=33)):s.count=33,u+="&count="+s.count,"min_id"in s&&(u+="&min_id="+s.min_id),"max_id"in s&&(u+="&max_id="+s.max_id)),jQuery.ajax({type:"POST",dataType:"jsonp",url:u,success:function(e){void 0===e.data&&(e.data=[]),o&&("object"==typeof s.success&&2==s.success.length?void 0!==window[s.success[0]]&&"function"==typeof window[s.success[0]][s.success[1]]&&(c&&(e=c(e,t.filterArguments,s.args)),window[s.success[0]][s.success[1]](e)):"string"==typeof s.success?"function"==typeof window[s.success]&&(c&&(e=c(e,t.filterArguments,s.args)),window[s.success](e)):"function"==typeof s.success&&(c&&(e=c(e,t.filterArguments,s.args)),s.success(e)))},error:function(e){n&&("object"==typeof s.error&&2==s.error.length?"function"==typeof window[s.error[0]][s.error[1]]&&window[s.error[0]][s.error[1]](e):"string"==typeof s.error?"function"==typeof window[s.error]&&window[s.error](e):"function"==typeof s.error&&s.error(e))},statusCode:i})},this.getUserMedia=function(e){var r=this,o=!1,i=this.statusCode,n=!1,c=this.getFilter("getUserMedia");void 0===e||0===e.length||("success"in e&&(o=!0),"error"in e&&(n=!0),"statusCode"in e&&(i=e.statusCode),"args"in e?!0:e.args={},"count"in e?(e.count=parseInt(e.count),(!Number.isInteger(e.count)||e.count<=0)&&(e.count=20)):e.count=20),jQuery.ajax({type:"POST",url:wdi_ajax.ajax_url,dataType:"json",data:{wdi_nonce:wdi_ajax.wdi_nonce,action:"wdi_getUserMedia",user_name:t()},success:function(t){t.meta={code:200},o&&("object"==typeof e.success&&2==e.success.length?void 0!==window[e.success[0]]&&"function"==typeof window[e.success[0]][e.success[1]]&&(c&&(t=s.addTags(t),t=c(t,r.filterArguments,e)),window[e.success[0]][e.success[1]](t)):"string"==typeof e.success?"function"==typeof window[e.success]&&(c&&(t=s.addTags(t),t=c(t,r.filterArguments,e)),window[e.success](t)):"function"==typeof e.success&&(c&&(t=s.addTags(t),t=c(t,r.filterArguments,e)),e.success(t)))},error:function(s){n&&("object"==typeof e.error&&2==e.error.length?"function"==typeof window[e.error[0]][e.error[1]]&&window[e.error[0]][e.error[1]](s):"string"==typeof e.error?"function"==typeof window[e.error]&&window[e.error](s):"function"==typeof e.error&&e.error(s))},statusCode:i})},this.getUserInfo=function(e,s){var t=this,o=!1,i=this.statusCode,n=!1,c=this.getFilter("getUserInfo");void 0===s||0===s.length||("success"in s&&(o=!0),"error"in s&&(n=!0),"statusCode"in s&&(i=s.statusCode)),jQuery.ajax({type:"POST",dataType:"jsonp",url:"https://api.instagram.com/v1/users/"+e+"/?access_token="+r(),success:function(e){o&&("object"==typeof s.success&&2==s.success.length?void 0!==window[s.success[0]]&&"function"==typeof window[s.success[0]][s.success[1]]&&(c&&(e=c(e,t.filterArguments)),window[s.success[0]][s.success[1]](e)):"string"==typeof s.success?"function"==typeof window[s.success]&&(c&&(e=c(e,t.filterArguments)),window[s.success](e)):"function"==typeof s.success&&(c&&(e=c(e,t.filterArguments)),s.success(e)))},error:function(e){n&&("object"==typeof s.error&&2==s.error.length?"function"==typeof window[s.error[0]][s.error[1]]&&window[s.error[0]][s.error[1]](e):"string"==typeof s.error?"function"==typeof window[s.error]&&window[s.error](e):"function"==typeof s.error&&s.error(e))},statusCode:i})},this.getSelfInfo=function(e){var t=this,o=!1,i=this.statusCode,n=!1,c=this.getFilter("getSelfInfo");void 0===e||0===e.length||("success"in e&&(o=!0),"error"in e&&(n=!0),"statusCode"in e&&(i=e.statusCode));var u="https://graph.facebook.com/v3.2/"+(void 0!==s.user&&void 0!==s.user.user_id?s.user.user_id:"undefined"!=typeof wdi_object&&void 0!==wdi_object.user?wdi_object.user.user_id:"")+"?fields=id,ig_id,username,name,biography,profile_picture_url,followers_count,follows_count,media_count,website&access_token="+r();s.getDataFromCache(function(r){var a;!1===r?jQuery.ajax({type:"POST",dataType:"jsonp",url:u,statusCode:i,success:function(r){s.setDataToCache(u,r),o&&("object"==typeof e.success&&2==e.success.length?void 0!==window[e.success[0]]&&"function"==typeof window[e.success[0]][e.success[1]]&&(c&&(r.meta={code:200},r=c(r,t.filterArguments)),window[e.success[0]][e.success[1]](r)):"string"==typeof e.success?"function"==typeof window[e.success]&&(c&&(r.meta={code:200},r=c(r,t.filterArguments)),window[e.success](r)):"function"==typeof e.success&&(c&&(r.meta={code:200},r=c(r,t.filterArguments)),e.success(r)))},error:function(s){n&&("object"==typeof e.error&&2==e.error.length?"function"==typeof window[e.error[0]][e.error[1]]&&window[e.error[0]][e.error[1]](s):"string"==typeof e.error?"function"==typeof window[e.error]&&window[e.error](s):"function"==typeof e.error&&e.error(s))}}):(a=r,o&&("object"==typeof e.success&&2==e.success.length?void 0!==window[e.success[0]]&&"function"==typeof window[e.success[0]][e.success[1]]&&(c&&(a=c(a,t.filterArguments)),window[e.success[0]][e.success[1]](a)):"string"==typeof e.success?"function"==typeof window[e.success]&&(c&&(a=c(a,t.filterArguments)),window[e.success](a)):"function"==typeof e.success&&(c&&(a=c(a,t.filterArguments)),e.success(a))))},u)},this.getRecentMediaComments=function(e,t){var o=this,i=!1,n=this.statusCode,c=!1,u=this.getFilter("getRecentMediaComments");void 0===t||0===t.length||("success"in t&&(i=!0),"error"in t&&(c=!0),"statusCode"in t&&(n=t.statusCode));var a="https://api.instagram.com/v1/media/"+e+"/comments?access_token="+r();s.getDataFromCache(function(e){function r(e){i&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(u&&(e=u(e,o.filterArguments)),window[t.success[0]][t.success[1]](e)):"string"==typeof t.success?"function"==typeof window[t.success]&&(u&&(e=u(e,o.filterArguments)),window[t.success](e)):"function"==typeof t.success&&(u&&(e=u(e,o.filterArguments)),t.success(e)))}!1===e?jQuery.ajax({type:"POST",dataType:"jsonp",url:a,success:function(e){s.setDataToCache(a,e),r(e)},error:function(e){c&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:n}):r(e)},a)},this.getRecentMediaLikes=function(e,s){var t=this,o=!1,i=this.statusCode,n=!1,c=this.getFilter("getRecentMediaLikes");void 0===s||0===s.length||("success"in s&&(o=!0),"error"in s&&(n=!0),"statusCode"in s&&(i=s.statusCode)),jQuery.ajax({type:"POST",dataType:"jsonp",url:"https://api.instagram.com/v1/media/"+e+"/likes?access_token="+r(),success:function(e){o&&("object"==typeof s.success&&2==s.success.length?void 0!==window[s.success[0]]&&"function"==typeof window[s.success[0]][s.success[1]]&&(c&&(e=c(e,t.filterArguments)),window[s.success[0]][s.success[1]](e)):"string"==typeof s.success?"function"==typeof window[s.success]&&(c&&(e=c(e,t.filterArguments)),window[s.success](e)):"function"==typeof s.success&&(c&&(e=c(e,t.filterArguments)),s.success(e)))},error:function(e){n&&("object"==typeof s.error&&2==s.error.length?"function"==typeof window[s.error[0]][s.error[1]]&&window[s.error[0]][s.error[1]](e):"string"==typeof s.error?"function"==typeof window[s.error]&&window[s.error](e):"function"==typeof s.error&&s.error(e))},statusCode:i})},this.requestByUrl=function(e,t){var o,i=this,n=!1,c=!1,u=this.statusCode,a=this.getFilter("requestByUrl");o=e.split("?")[1].split("&");for(var d=0;d<o.length;d++)o[d]=o[d].split("="),"access_token"==o[d][0]&&(o[d][1]=r()),o[d]=o[d].join("=");o=o.join("&"),e=e.split("?")[0]+"?"+o,void 0===t||0===t.length||("success"in t&&(n=!0),"args"in t?!0:t.args={},"error"in t&&(c=!0),"statusCode"in t&&(u=t.statusCode));s.getDataFromCache(function(r){var o;!1===r?jQuery.ajax({type:"POST",dataType:"jsonp",url:e,success:function(r){s.setDataToCache(e,r),n&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(a&&(r=a(r,i.filterArguments,t.args)),window[t.success[0]][t.success[1]](r)):"string"==typeof t.success?"function"==typeof window[t.success]&&(a&&(r=a(r,i.filterArguments,t.args)),window[t.success](r)):"function"==typeof t.success&&(a&&(r=a(r,i.filterArguments,t.args)),t.success(r)))},error:function(e){c&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:u}):(o=r,n&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(a&&(o=a(o,i.filterArguments,t.args)),window[t.success[0]][t.success[1]](o)):"string"==typeof t.success?"function"==typeof window[t.success]&&(a&&(o=a(o,i.filterArguments,t.args)),window[t.success](o)):"function"==typeof t.success&&(a&&(o=a(o,i.filterArguments,t.args)),t.success(o))))},e)},this.getDataFromCache=function(e,s,t){void 0===t&&(t=!0),jQuery.ajax({type:"POST",async:t,url:wdi_ajax.ajax_url,dataType:"json",data:{wdi_cache_name:s,wdi_nonce:wdi_ajax.wdi_nonce,WDI_MINIFY:wdi_ajax.WDI_MINIFY,task:"get",action:"wdi_cache"},success:function(s){if(s.success)if(void 0!==s.cache_data&&null!==s.cache_data){var t=JSON.parse(s.cache_data);e(t)}else e(!1);else e(!1)}})},this.setDataToCache=function(e,s){jQuery.ajax({type:"POST",url:wdi_ajax.ajax_url,dataType:"json",data:{wdi_cache_name:e,wdi_cache_response:JSON.stringify(s),wdi_nonce:wdi_ajax.wdi_nonce,task:"set",action:"wdi_cache"},success:function(e){}})}}